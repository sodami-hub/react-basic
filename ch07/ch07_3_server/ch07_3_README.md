# ch07-3 ìµìŠ¤í”„ë ˆìŠ¤ í”„ë ˆì„ì›Œí¬ë¡œ API ì„œë²„ ë§Œë“¤ê¸°
ì´ ì ˆì—ì„œëŠ” ëŒ€í‘œì ì¸ Node.js ê¸°ë°˜ ì›¹ í”„ë ˆì„ì›Œí¬ì¸ ìµìŠ¤í”„ë ˆìŠ¤ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ì—¬ API ì„œë²„ë¥¼ ë§Œë“œëŠ” ë°©ë²•ì„ ì•Œì•„ë³¸ë‹¤.

## ğŸˆ TCP/IP í”„ë¡œí† ì½œ ì•Œì•„ë³´ê¸°
TCP/IP í”„ë¡œí† ì½œì€ IP í”„ë¡œí† ì½œ ê¸°ë°˜ì—ì„œ ë°ì´í„° ì „ì†¡ ë°©ì‹ì„ ì œì–´í•˜ëŠ” TCP í”„ë¡œí† ì½œì„ í•¨ê»˜ í˜¸ì¹­í•˜ëŠ” ìš©ì–´ì´ë‹¤. TCP/IP í”„ë¡œí† ì½œì„
ì‚¬ìš©í•˜ëŠ” ì‹œìŠ¤í…œì€ í•­ìƒ ë°ì´í„°ë¥¼ ìš”ì²­í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë¨ê³¼ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ” ì„œë²„ í”„ë¡œê·¸ë¨ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. ì„œë²„ í”„ë¡œê·¸ë¨ì€
í•­ìƒ í´ë¼ì´ì–¸íŠ¸ì˜ ë°ì´í„° ìš”ì²­ì´ ìˆëŠ”ì§€ ì•Œê¸° ìœ„í•´ íŠ¹ì • í¬íŠ¸ë¥¼ ê°ì‹œí•˜ê³  ìˆì–´ì•¼ í•˜ëŠ”ë°, ì´ ê³¼ì •ì„ ë¦¬ìŠ¨(Listen)ì´ë¼ê³  í•œë‹¤.
í¬íŠ¸ì˜ ëª©ì ì´ ì´ì²˜ëŸ¼ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë¦¬ìŠ¨í•˜ëŠ” ë° ìˆìœ¼ë¯€ë¡œ ì–´ë–¤ TCP/IP ì„œë²„ê°€ íŠ¹ì • í¬íŠ¸ë¥¼ ë¦¬ìŠ¨í•˜ê³  ìˆì„ ë•Œ ë‹¤ë¥¸ TCP/IP ì„œë²„ëŠ”
ì´ í¬íŠ¸ì— ì ‘ê·¼í•˜ì§€ ëª»í•œë‹¤.  
TCP/IP ì—°ê²°ì´ ë˜ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ëª¨ë‘ ì†Œì¼“ì´ë¼ëŠ” í† í°ì„ ì–»ëŠ”ë‹¤. ê·¸ë¦¬ê³  ì—°ê²°ëœ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì´ ì†Œì¼“ì„ í†µí•´ ì–‘ë°©í–¥ìœ¼ë¡œ
ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤. ì´ ë°©ì‹ì€ ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ í•œ ëŒ€ì˜ ì„œë²„ì— ì ‘ì†í•˜ëŠ” ìƒí™©ì—ì„œ ê°ê°ì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.
ì¦‰, ê° í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë¡œ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ì†Œì¼“ ë²ˆí˜¸ë¥¼ ê°€ì§€ë¯€ë¡œ ì„œë²„ ì…ì¥ì—ì„œ ì†Œì¼“ê°’ì„ ê°€ì§€ê³  ê°ê°ì˜ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‰½ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.  
HTTP í”„ë¡œí† ì½œì€ TCP/IP í”„ë¡œí† ì½œ ìœ„ì—ì„œ ë™ì‘í•˜ëŠ” ì•± ìˆ˜ì¤€ í”„ë¡œí† ì½œì´ë‹¤. HTTP ì„œë²„, ì¦‰ ì›¹ ì„œë²„ëŠ” TCP/IP í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ë¯€ë¡œ
í•­ìƒ ì›¹ ë¸Œë¼ìš°ì €ì™€ ê°™ì€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ì‘ë‹µí•  ìˆ˜ ìˆë„ë¡ íŠ¹ì • í¬íŠ¸ë¥¼ ë¦¬ìŠ¨í•˜ê³  ìˆì–´ì•¼ í•œë‹¤.

## ğŸˆ Node.js ì›¹ ì„œë²„ ë§Œë“¤ê¸°
Node.jsëŠ” ì›¹ ë¸Œë¼ìš°ì €ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ ë¶€ë¶„ë§Œ ë–¼ì–´ ë‚´ì–´, C/C++ ì–¸ì–´ë¡œ HTTP í”„ë¡œí† ì½œì„ êµ¬í˜„í•˜ì—¬ ë…ë¦½ì ì¸ í”„ë¡œê·¸ë¨ í˜•íƒœë¡œ ë™ì‘í•˜ëŠ”
ì›¹ ì„œë²„ ê¸°ëŠ¥ì„ ê°€ì§„ ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì„ êµ¬í˜„í•œ ê²ƒì´ë‹¤.  
Node.js ëŠ” http ë€ ì´ë¦„ì˜ íŒ¨í‚¤ì§€ë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ë©° ì´ íŒ¨í‚¤ì§€ëŠ” createServer ë¼ëŠ” í•¨ìˆ˜ë¥¼ ì œê³µí•˜ì—¬ ì›¹ ì„œë²„ ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```typescript
import {createServer} from 'http'

function createServer(requestListener?: RequestListener): Server;

type RequestListener = (req: IncomingMessage, res: ServerResponse) => void
```
createServer ì˜ ì„ ì–¸ë¬¸ì„ ë³´ë©´ ì„ íƒì ìœ¼ë¡œ RequestListener íƒ€ì…ì˜ ì½œë°± í•¨ìˆ˜ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì…ë ¥ ë°›ì„ ìˆ˜ ìˆê³ , RequestListener íƒ€ì…ì€
IncomingMessage ì™€ ServerResponse íƒ€ì… ë§¤ê°œë³€ìˆ˜ 2ê°œë¥¼ ì…ë ¥ë°›ëŠ” í•¨ìˆ˜ íƒ€ì…ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤.  
src/index.ts íŒŒì¼ì„ ì‘ì„±í•œë‹¤. HTTP ì„œë²„ ë˜í•œ TCP/IP ì„œë²„ì´ë¯€ë¡œ listen ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ 4000ë²ˆ í¬íŠ¸ë¥¼ ë¦¬ìŠ¨í•˜ê³  ìˆë‹¤.
ì—¬ê¸°ì„œ í¬íŠ¸ ë²ˆí˜¸ë¥¼ 4000ìœ¼ë¡œ í•œ ì´ìœ ëŠ” í˜„ì¬ í¬íŠ¸ ë²ˆí˜¸ 3000ì€ ë¦¬ì•¡íŠ¸ ê°œë°œ ì„œë²„ë¡œ ì‚¬ìš© ì¤‘ì´ê¸° ë•Œë¬¸ì— ì´ ë²ˆí˜¸ì™€ ë‹¤ë¥¸ í¬íŠ¸ ë²ˆí˜¸ë¥¼ ì‚¬ìš©í•œë‹¤.  
```shell
>ts-node src
```
ì°¸ê³ ë¡œ ts-node ì— ë””ë ‰í„°ë¦¬ ì´ë¦„ë§Œ ì ìš©í•˜ë©´ í•´ë‹¹ ë””ë ‰í„°ë¦¬ ì•ˆì— index.ts íŒŒì¼ì„ ì°¾ì•„ ì‹¤í–‰í•´ ì¤€ë‹¤. ì„œë²„ ì£¼ì†Œë¡œ ì ‘ì†ì„í•˜ê³ ,
ì„œë²„ë¥¼ ì‹¤í–‰í•œ í„°ë¯¸ë„ì„ ë³´ë©´ console.log ê°€ ì¶œë ¥í•œ ë‚´ìš©ì„ ë³¼ ìˆ˜ ìˆë‹¤.
```shell
req.url /
req.method GET
req.headers {
  host: 'localhost:4000',
  connection: 'keep-alive',
  'sec-ch-ua': '"Chromium";v="134", "Not:A-Brand";v="24", "Google Chrome";v="134"',
  'sec-ch-ua-mobile': '?0',
  
  ... (ìƒëµ) ...
```

## ğŸˆ REST ë°©ì‹ API ì„œë²„
ì›¹ ì„œë²„ëŠ” ì›ë˜ ì›¹ ë¸Œë¼ìš°ì €ì™€ ê°™ì€ HTTP í´ë¼ì´ì–¸íŠ¸ì—ê²Œ HTML í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì „ì†¡í•´ì£¼ëŠ” ëª©ì ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆì§€ë§Œ, ì ì°¨ HTML ì´ ì•„ë‹Œ JSON
í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì „ì†¡í•´ ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í™”ë˜ì—ˆë‹¤. ì´ ë‘ ë°©ì‹ì„ êµ¬ë¶„í•˜ê¸° ìœ„í•´ HTML í˜•ì‹ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ì„œë²„ë¥¼ ì›¹ ì„œë²„, JSON í˜•ì‹
ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ì„œë²„ë¥¼ API ì„œë²„ë¼ê³  í•œë‹¤.  
**REST(representational state transfer)** ë¼ëŠ” ìš©ì–´ëŠ” HTTP í”„ë¡œí† ì½œì˜ ì£¼ìš” ì €ì ì¤‘ í•œ ì‚¬ëŒì¸ ë¡œì´ í•„ë”©ì˜ 2000ë…„ ë°•ì‚¬í•™ìœ„ ë…¼ë¬¸ì—ì„œ ì²˜ìŒ ì†Œê°œëë‹¤. ì•ì„œ src/index.ts íŒŒì¼
ì‹¤í–‰ ê²°ê³¼ì—ì„œ req.method ë¶€ë¶„ì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, REST ëŠ” req.methodì˜ ì„¤ì •ê°’ì„ ë‹¤ë¥´ê²Œ í•˜ì—¬ API ì„œë²„ ìª½ì—ì„œ DB ì˜ CRUD ì‘ì—…ì„ ì‰½ê²Œ
êµ¬ë¶„í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ëœë‹¤.(Create(CRUDì‘ì—…) - POST(HTTP ë©”ì„œë“œ ì´ë¦„), Read - GET, Update - PUT, Delete - DELETE)  
REST API ì˜ ê¸°ë³¸ ì›ë¦¬ëŠ” 'http://localhost:4000/user', 'http://localhost:4000/list' ì²˜ëŸ¼ ê²½ë¡œì— ìì‹ ì´ ì›í•˜ëŠ” '/user', '/list'
ê°™ì€ ìì›ì„ ëª…ì‹œí•˜ê³ , ì´ ìì›ì— ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê³  ì‹¶ìœ¼ë©´ POST ë©”ì„œë“œë¥¼, ë‹¨ìˆœíˆ ê²€ìƒ‰í•˜ê³  ì‹¶ìœ¼ë©´ GET ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.  
ì´ëŸ¬í•œ ë°©ì‹ì€ íŠ¹ì • ìì›ì„ í•­ìƒ ì¼ì •í•˜ê²Œ ì‚¬ìš©í•˜ë¯€ë¡œ ì¼ê´€ëœ ë°©ì‹ìœ¼ë¡œ APIë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤. ì´ì œ REST ë°©ì‹ API ì„œë²„ë¥¼ êµ¬í˜„í•´ ë³´ê² ë‹¤.
ê·¸ì „ì— ìµìŠ¤í”„ë ˆìŠ¤ í”„ë ˆì„ì›Œí¬ë¥¼ ì„¤ì¹˜í•œë‹¤.

## ğŸˆ ìµìŠ¤í”„ë ˆìŠ¤ ì„¤ì¹˜í•˜ê¸°
ìµìŠ¤í”„ë ˆìŠ¤ í”„ë ˆì„ì›Œí¬ëŠ” Node.js í™˜ê²½ì—ì„œ ì‚¬ì‹¤ìƒ í‘œì¤€ ì›¹ í”„ë ˆì„ì›Œí¬ì´ë‹¤. ìµìŠ¤í”„ë ˆìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì›¹ ì„œë²„ëŠ” ë¬¼ë¡œ REST ë°©ì‹ API ì„œë²„ë¥¼ ì‰½ê²Œ
ë§Œë“¤ ìˆ˜ ìˆë‹¤.  
ìµìŠ¤í”„ë ˆìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ REST ë°©ì‹ API ì„œë²„ë¥¼ ë§Œë“¤ë ¤ë©´ ë‹¤ìŒì²˜ëŸ¼ express ì™€ cors ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì•¼ í•œë‹¤. ê·¸ë¦¬ê³  ì¢€ ë” í¸ë¦¬í•˜ê²Œ ê°œë°œí•˜ê³ ì
í•œë‹¤ë©´ nodemon íŒ¨í‚¤ì§€ë„ ì„¤ì¹˜í•œë‹¤. ì°¸ê³ ë¡œ nodemon ì€ ê°œë°œí•  ë•Œë§Œ í•„ìš”í•˜ë¯€ë¡œ -D ì˜µì…˜ìœ¼ë¡œ ì…œì¹˜í•œë‹¤.
```shell
> yarn add express cors
> yarn add -D @types/express @types/cors nodemon
```

ê·¸ë¦¬ê³  nodemon íŒ¨í‚¤ì§€ê°€ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ package.json ì„ ë‹¤ìŒì²˜ëŸ¼ ìˆ˜ì •í•œë‹¤. ê·¸ë¦¬ê³  í„°ë¯¸ë„ì—ì„œ yarn start
ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤. ì°¸ê³ ë¡œ macOS ì—ì„œëŠ” 'ts-node src' ì²˜ëŸ¼ ì‘ì€ë”°ì˜´í‘œë¡œ ê°ì‹¼ë‹¤.

```
{
  "name" : "...",
  ... (ìƒëµ) ...
  
  "scripts" : {
    "start" : "nodemon -e ts --exec ts-node src --watch src",
    "start-mac" : "nodemon -e ts --exec 'ts-node src' --watch src"
  }
  ...(ìƒëµ)...
}
```

ë‹¤ìŒì€ nodemonì„ ì‹¤í–‰í•œ ëª¨ìŠµì´ë‹¤. nodemon ì€ src ë””ë ‰í„°ë¦¬ì˜ íŒŒì¼ í™•ì¥ìê°€ .ts ì¸ íŒŒì¼ì´ ìˆ˜ì •ë˜ë©´ í”„ë¡œê·¸ë¨ì„ ìë™ìœ¼ë¡œ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬
ë³€ê²½ ë‚´ìš©ì„ ì¦‰ì‹œ ë°˜ì˜í•œë‹¤.
```shell
"C:\Program Files\nodejs\npm.cmd" run start

> ch07_3_server@1.0.0 start
> nodemon -e ts --exec ts-node src --watch src

[nodemon] 3.1.9
[nodemon] to restart at any time, enter `rs`
[nodemon] watching path(s): src\**\*
[nodemon] watching extensions: ts
[nodemon] starting `ts-node src`
connect http://localhost:4000
```

## ğŸˆ ìµìŠ¤í”„ë ˆìŠ¤ REST API ì„œë²„ ë§Œë“¤ê¸°



### ğŸ•¸ï¸

































